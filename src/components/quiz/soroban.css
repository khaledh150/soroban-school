/* src/components/quiz/soroban.css */

.soroban-wrapper {
  display: flex;
  justify-content: center;
  align-items: center;
  width: 100%;
  height: 100%;
  overflow: hidden;
  /* Prevent browser gestures/scrolling on the wrapper */
  touch-action: none; 
}

/* Main board */
.soroban {
  display: flex;
  justify-content: center;
  align-items: center;
  background: #3586fe;
  padding: 5px;
  box-shadow: 0 0 15px rgba(0, 0, 0, 0.3);
  overflow: hidden;
  border-top: 30px solid #3586fe;
  border-bottom: 30px solid #3586fe;
  box-sizing: border-box;
  /* Prevent text selection when tapping wildly */
  user-select: none;
  -webkit-user-select: none;
}

/* Shake animation â€“ same feel as original */
.soroban.shake {
  animation: shake 0.21s cubic-bezier(0.62, 1.75, 0.52, 0.91);
  /* Optimize animation performance */
  will-change: transform;
}

@keyframes shake {
  0%, 100% { transform: translateX(0); }
  10%, 30%, 50%, 70%, 90% { transform: translateX(-8px); }
  20%, 40%, 60%, 80% { transform: translateX(8px); }
}

/* Rods */
.rod {
  position: relative;
  width: 95px;
  height: 350px;
  background: #3586fe;
  border-radius: 5px;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: space-between;
}

.rod-line {
  position: absolute;
  top: 0;
  bottom: 0;
  width: 3px;
  background: #b7cefd;
  z-index: 0;
  pointer-events: none; /* Let clicks pass through to beads/background */
}

/* Heaven / earth layout */
.heaven {
  display: flex;
  flex-direction: column;
  justify-content: flex-end;
  align-items: center;
  height: 14%;
  gap: 2px;
  z-index: 1;
}

.gap-space {
  height: 2%;
  z-index: 1;
}

.earth {
  display: flex;
  flex-direction: column;
  justify-content: flex-start;
  align-items: center;
  height: 53%;
  margin-top: 3px;
  z-index: 1;
  gap: 3px;
}

/* Bar between heaven and earth */
.bar {
  position: absolute;
  top: 27%;
  width: 100%;
  height: 3px;
  background: #99b3ff;
  z-index: 2;
  pointer-events: none;
}

/* --- NEW: Unit Marker (The Heart) --- */
.unit-marker {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -60%); /* -60% to visually center the heart better on the thin line */
  font-size: 14px; 
  line-height: 1;
  z-index: 2; /* Same as bar, so active beads (z-index 3) cover it */
  pointer-events: none;
  filter: drop-shadow(0 1px 1px rgba(0,0,0,0.2));
}

/* Beads */
.bead {
  width: 90px;
  height: 50px;
  margin: 0;
  background: linear-gradient(to bottom, #002db3, #002080);
  clip-path: polygon(
    25% 0%,
    75% 0%,
    100% 50%,
    75% 100%,
    25% 100%,
    0% 50%
  );
  box-shadow: inset -1px -1px 4px rgba(255, 255, 255, 0.3),
    inset 1px 1px 4px rgba(0, 0, 0, 0.3);
  transition: transform 0.2s;
  /* Critical for 60fps on mobile */
  will-change: transform;
  touch-action: none;
  z-index: 3;
  cursor: pointer;
}

/* Active bead color */
.bead.active {
  background: radial-gradient(circle at 30% 30%, #ffd700, #ffa500);
  box-shadow: inset -2px -2px 5px rgba(255, 255, 255, 0.4),
    inset 2px 2px 5px rgba(0, 0, 0, 0.3);
}

/* Heaven bead moves down */
.bead.heaven.active {
  transform: translateY(100%);
}

/* Earth beads move up */
.bead.earth.active {
  transform: translateY(-150%);
}

/* Shake animation (used on reset & device shake) */
.soroban-wrapper.shake {
  animation: soroban-shake 0.21s cubic-bezier(.62, 1.75, .52, .91);
}

@keyframes soroban-shake {
  0%, 100% { transform: translateX(0); }
  10%, 30%, 50%, 70%, 90% { transform: translateX(-8px); }
  20%, 40%, 60%, 80% { transform: translateX(8px); }
}